# extract polygon boundaries from a geojson file
# formatted them in WKT suitable for upload to USFS SMART
# Coordinates need to be in Web Mercator EPSG: 3857 (meters)

# Note:
# Error on multi-part polygons (and likely other features)
# An additional (third) set of parenthesis needs to be added around the entire polygon string
# See the bottom of this file for example
# Also, SMART doesn't seem to like Polygons labeled as Multipolygons, if they only have 1 feature.


import json

geo = open('SMART_GeoJSON.geojson', 'r')
j = json.loads(geo.read())

for f in j['features']:   # Loop through each of the features in the geojson file

    print('\n\n')
    print(f['properties']['PlanName'] + '\n')   # name of the feature
    

    componentlist = []  # for storing each geometry or geometries in feature
    
    for c in f['geometry']['coordinates']:
    
        for d in c:
            coordlist = []
                                   
            for e in d:
                coordlist.append(str(e[0]) + ' ' + str(e[1]))
            
            componentlist.append('(' + ','.join(coordlist) + ')')

    print(f['geometry']['type'].upper() + ' (' + ', '.join(componentlist) + ')')



'''
# current output of multipart polygon
MULTIPOLYGON ((-12362623.8 4858738.21,-12364648.33 4858734.5,-12364650.69 4858803.23,-12366748.45 4858812.25,-12367802.33 4858813.05,-12367806.79 4859866.24,-12367795.73 4861972.03,-12366748.17 4861972.12,-12364665.4 4861965.06,-12364664.63 4861901.78,-12362630.73 4861895.41,-12362626.9 4859792.33,-12362623.8 4858738.21), (-12363189.83 4869471.27,-12363191.43 4869238.91,-12363339.29 4869259.52,-12364008.48 4869032.09,-12364663.26 4869327.33,-12364666.34 4868375.91,-12362589.3 4868367.88,-12362590.6 4867306.88,-12361546.81 4867303.61,-12361546.1 4866244.67,-12363635.09 4866249.52,-12363644.09 4865196.0,-12364675.47 4865200.75,-12364687.93 4864147.91,-12366775.38 4864165.15,-12366765.38 4866281.09,-12366768.35 4867759.2,-12367120.17 4867368.32,-12367381.31 4867368.02,-12367368.37 4869463.33,-12363189.83 4869471.27))

# ERRORR!!!!
# Script omitted a set of parenthesis.  The WKT on the next line is correct
MULTIPOLYGON (((-12362623.7985976 4858738.21359521, -12364648.3311111 4858734.49588178, -12364650.6910843 4858803.22762786, -12366748.4488908 4858812.24941366, -12367802.3280986 4858813.05200565, -12367806.7918989 4859866.23940468, -12367795.734983 4861972.03232202, -12366748.1741543 4861972.12020381, -12364665.4008418 4861965.06104694, -12364664.632626 4861901.78161008, -12362630.7339132 4861895.40942845, -12362626.9043001 4859792.33325939, -12362623.7985976 4858738.21359521)), ((-12363189.8339407 4869471.26587383, -12363191.4304848 4869238.90878429, -12363339.2922683 4869259.52324304, -12364008.4754722 4869032.09497827, -12364663.2610585 4869327.3289514, -12364666.3422707 4868375.90583331, -12362589.3011327 4868367.88337252, -12362590.6011217 4867306.8784246, -12361546.8074598 4867303.60790072, -12361546.0972414 4866244.66639932, -12363635.0935361 4866249.52494102, -12363644.0897095 4865196.00294652, -12364675.4719161 4865200.75141375, -12364687.9303482 4864147.9113056, -12366775.3801926 4864165.14573921, -12366765.3772458 4866281.08844469, -12366768.3530384 4867759.19849944, -12367120.1748381 4867368.32023333, -12367381.3122185 4867368.01865665, -12367368.3709937 4869463.33076591, -12363189.8339407 4869471.26587383)))
'''